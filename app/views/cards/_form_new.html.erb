<%= form_for @card, url: share_template_path(@card.template.token), method: "post" do |f| %>
  <% if @card.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@card.errors.count, "error") %> prohibited this card from being saved:</h2>

      <ul>
      <% @card.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :is_public %><br>
    <%= f.check_box :is_public %>
  </div>
  
  <% @size = @card.template.size %>
  <% @this_col = 0 %>
  <table class="table table-bordered table-condensed">
    <tbody class="table-striped">
    <%= f.fields_for :circles do |ff| %>
      <%# when the mod of the @this_col % @size == 0, then make a new row, otherwise, make a new cell %>
      
      <% if @this_col % @size == 0  %>
        <tr>
      <% end  %>
      <td>
        <div class="col col-xs-12">
          <div class="form-group">
            <%= ff.hidden_field :position_x %>
            <%= ff.hidden_field :position_y %>
          </div>
          <div class="form-group">
            <%= ff.label :question %><br>
            <%= ff.text_field :question, class: "form-control", :readonly => true %>
          </div> 
           <div class="form-group">
             <%= ff.label :response %><br>
             <%= ff.text_field :response, class: "form-control" %>
           </div>
        </div>
      </td>
      <%# When it's the end of the row (ie % is -1), then end the row %>
      <% if @this_col % @size == (@size - 1)  %>
        </tr>
      <% end  %>
      <% @this_col += 1 %>
    <% end %>
      
    </tbody>
    
  </table>
  
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
