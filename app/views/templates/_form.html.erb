<%= form_for [@organization, @template] do |f| %>
  <% if @template.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@template.errors.count, "error") %> prohibited this template from being saved:</h2>

      <ul>
      <% @template.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <div class="col col-xs-12">
    <div class="form-group">
      <%= f.label :size %><br>
      <%= f.select :size, options_for_select((@template.size ..@template.size).collect {|s| s }), class: "form-control" %>
    </div>
    <div class="form-group">
      <%= f.label :name %><br>
      <%= f.text_field :name, class: "form-control" %>
    </div>
    <div class="form-group">
      <%= f.label :rating %><br>
      <%= f.select :rating, options_for_select(@ratings.collect { |s| [s[0].humanize, s[0]] }), class: "form-control" %>
    </div>
    <div class="form-group">
      <%= f.label :is_public %><br>
      <%= f.check_box :is_public, class: "form-control" %>
    </div>
   </div>
   <%# @size and @this_col will be used to determine if should make rows or cells in the table %>
  <% @size = @template.size %>
  <% @this_col = 0 %>
  <table class="table table-bordered table-condensed">
    <tbody class="table-striped">
    <%= f.fields_for :squares do |ff| %>
      <%# when the mod of the @this_col % @size == 0, then make a new row, otherwise, make a new cell %>
      
      <% if @this_col % @size == 0  %>
        <tr>
      <% end  %>
      <td>
        <div class="col col-xs-12">
          <div class="form-group">
            <%= ff.hidden_field :position_x %>
            <%= ff.hidden_field :position_y %>
          </div>
          <div class="form-group">
            <%= ff.label :question %><br>
            <%= ff.text_field :question, class: "form-control" %>
          </div> 
           <div class="form-group">
             <%= ff.label :free_space %><br>
             <%= ff.check_box :free_space, class: "form-control" %>
           </div>
        </div>
      </td>
      <%# When it's the end of the row (ie % is -1), then end the row %>
      <% if @this_col % @size == (@size - 1)  %>
        </tr>
      <% end  %>
      <% @this_col += 1 %>
    <% end %>
      
    </tbody>
    
  </table>
  
  <div class="actions form-group">
    <%= f.button class: "btn accent-background" %>
  </div>
<% end %>
